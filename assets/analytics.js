!function(){"use strict";var e=[,function(e,t,a){a.r(t),a.d(t,{default:function(){return n}});class n{static buildQueryString(e){return Object.keys(e).map((t=>{const a=e[t];return""!==a&&null!=a?encodeURIComponent(t)+"="+encodeURIComponent(a):encodeURIComponent(t)})).join("&")}static getQueryVars(e){const t=(e||window.location.search.substring(1)).split("&"),a={};return t.forEach((e=>{const t=e.split("="),n=decodeURIComponent(t.shift()),r=decodeURIComponent(t.join("="));n&&(a[n]=r)})),a}static setQueryVars(e){const t=n.buildQueryString(e);return`${location.pathname}?${t}`}static deleteQueryVar(e){const t=n.getQueryVars();Array.isArray(e)||(e=[e]);for(const a of e)t.hasOwnProperty(a)&&delete t[a];return n.setQueryVars(t)}static setQueryVar(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const a=n.getQueryVars();return a[e]=t,n.setQueryVars(a)}static toBoolean(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const a="string"==typeof e?e.toLowerCase():e;if(t&&""===a)return!0;switch(a){case"":case"0":case"n":case"no":case"false":case"off":case"null":case void 0:case null:case!1:case 0:return!1;default:return!0}}}var r,o,c;c={A_OR_B:"a_or_b"},(o="keys")in(r=n)?Object.defineProperty(r,o,{value:c,enumerable:!0,configurable:!0,writable:!0}):r[o]=c},function(e,t,a){a.r(t),a.d(t,{SubscribeType:function(){return c},default:function(){return i}});var n=a(3),r=a(1);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const c={EMAIL:"email",PHONE:"phone"};class i{static getRefData(){const e=localStorage.getItem("krete-referral-id"),t=localStorage.getItem("krete-referral-time"),a=localStorage.getItem("krete-referral-hit-id");return!e||!a||!t||Date.now()-t>2592e6?null:{refId:e,refStamp:t,refHitId:a}}static validateRef(e){return e&&"string"==typeof e?(e=e.trim()).match(/^[a-zA-Z]-[0-9]{6}$/)?null:e:null}static async saveHit(e,t){const a=await n.default.getClientIdAsync(),r=await fetch(new Request(`https://krete-node.herokuapp.com/api/referral/hit?ref=${encodeURIComponent(e)}&cid=${a||""}&tags=${encodeURIComponent(t)}`)),o=await r.json();return o&&o.data?o.data._id:void 0}static async saveSubscribe(e,t){const a=i.getRefData();if(!a)return null;const n={ref:a.refId,subType:e,subValue:t,creditedHitId:a.refHitId},o=await fetch(new Request("https://krete-node.herokuapp.com/api/referral/subscribe?"+r.default.buildQueryString(n))),c=await o.json();return c&&c.data?c.data._id:void 0}}o(i,"refId",null),o(i,"creditedHitId",null)},function(e,t,a){a.r(t),a.d(t,{default:function(){return n},Category:function(){return r},Action:function(){return o}});class n{static event(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;null===n?(gtag("event",t,{event_category:e,event_label:a}),ga("send","event",e,t,a)):(gtag("event",t,{event_category:e,event_label:a,value:n}),ga("send","event",e,t,a,n)),console.log(`JS GA event: {category:${e}, action:${t}, label:${a}}, [value:${n}]`)}static enhancedEcommerceAddToCart(e,t,a,n,r){let o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"Krete";ga("set","&cu",liquid.CURRENCY_CODE);const i=a?`${t} - ${a}`:t;ga("ec:addProduct",{id:e,name:i,category:o,quantity:parseInt(n),price:parseFloat(r),brand:c,variant:a,currency:liquid.CURRENCY_CODE}),ga("ec:setAction","add"),ga("send","event",{eventCategory:"EnhancedEcommerce",eventAction:"Added Product",eventLabel:void 0,nonInteraction:!0}),console.log(`Manual EnhancedEcommerce Add To Cart Event: {sku:${e}, name:${i}, quantity:${n}, price:${r}}`)}static facebookPixelAddToCart(e,t,a,n,r){const o=a?`${t} - ${a}`:t;fbq("track","AddToCart",{content_category:arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",content_ids:[e],content_name:o,content_type:"product_group",currency:liquid.CURRENCY_CODE,num_items:n+"",value:r+""}),console.log(`Manual Facebook Pixel Add To Cart Event: {id:${e}, name:${o}, quantity:${n}, price:${r}}`)}static klaviyoAddToCart(e,t,a,n,r,o,c,i){const l=a?`${t} - ${a}`:t;let d={Name:l,ProductID:e,Categories:[arguments.length>8&&void 0!==arguments[8]?arguments[8]:""],ImageURL:i||"https://cdn.shopify.com/s/files/1/0338/0520/5563/products/product-straight-on_a6c6c44d-b055-444a-bc2e-34b633e5858c_grande.jpg?v=1632436242",URL:c||"https://krete.club/products/facial-serum",Brand:arguments.length>9&&void 0!==arguments[9]?arguments[9]:"Krete",Price:"$"+r,CompareAtPrice:"$"+o};_learnq.push(["track","Added to Cart",d]),console.log(`Manual LearnQ Add To Cart Event: {id:${e}, name:${l}, quantity:${n}, price:${r}}`)}static klaviyoViewedProduct(e,t,a,n,r,o,c){const i=a?`${t} - ${a}`:t;let l={Name:i,ProductID:e,Categories:[arguments.length>7&&void 0!==arguments[7]?arguments[7]:""],ImageURL:c||"https://cdn.shopify.com/s/files/1/0338/0520/5563/products/product-straight-on_a6c6c44d-b055-444a-bc2e-34b633e5858c_grande.jpg?v=1632436242",URL:o||"https://krete.club/products/facial-serum",Brand:arguments.length>8&&void 0!==arguments[8]?arguments[8]:"Krete",Price:"$"+n,CompareAtPrice:"$"+r};_learnq.push(["track","Viewed Product",l]),_learnq.push(["trackViewedItem",{Title:l.Name,ItemId:l.ProductID,Categories:l.Categories,ImageUrl:l.ImageURL,Url:l.URL,Metadata:{Brand:l.Brand,Price:l.Price,CompareAtPrice:l.CompareAtPrice}}]),console.log(`Manual LearnQ Viewed Product Event: {id:${e}, name:${i}, price:${n}}`)}static getClientId(){try{var e=ga.getAll();for(let t=0;t<e.length;t+=1)if("UA-186701400-1"===e[t].get("trackingId"))return e[t].get("clientId")}catch(e){}return!1}static async getClientIdAsync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;const a=Date.now(),r=1e3*t;return new Promise(((t,o)=>{let c=null;function i(){if(Date.now()-a>r)return t(null),void clearInterval(c);const e=n.getClientId();return!!e&&(t(e),clearInterval(c),!0)}i()||(c=setInterval(i,e))}))}}const r={SUBSCRIBE:"Subscribe",UPSELL:"Upsell",INTERACT:"Interact"},o={GAVE_EMAIL:"Submitted Email",GAVE_PHONE:"Submitted Phone Number",UPGRADED_TO_3_PACK:"Upgraded to 3 Pack",UPGRADED_TO_6_PACK:"Upgraded to 6 Pack",CHANGED_VARIANT:"Changed Selected Variant",CLICKED_CTA:"Clicked CTA"};n.Category=r,n.Action=o}],t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,a),o.exports}a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};!function(){a.r(n);var e,t,r,o,c,i,l,d,s,u,g=a(1),f=a(2),m=a(3);if(window.Krete.Analytics=m.default,window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},window._learnq=window._learnq||[],"true"===localStorage.getItem("krete-notrack"))window["ga-disable-UA-186701400-1"]=!0,window["ga-disable-G-VC1305JWHT"]=!0,window.fbq=function(){};else{const a=g.default.getQueryVars(),n=f.default.validateRef(a.ref),m=a.tags||"";n&&async function(){delete a.ref,a.tags&&delete a.tags,a.utm_campaign&&delete a.utm_campaign,a.utm_term&&delete a.utm_term,a.utm_content&&delete a.utm_content,a.utm_medium="referral_program",a.utm_source="ref_"+n,history.replaceState(null,"",location.pathname+"?"+g.default.buildQueryString(a)+location.hash),localStorage.setItem("krete-referral-id",n),localStorage.setItem("krete-referral-time",Date.now());const e=await f.default.saveHit(n,m);e&&localStorage.setItem("krete-referral-hit-id",e)}(),gtag("js",new Date),gtag("config","G-VC1305JWHT"),c=window,i=document,l="script",c.fbq||(d=c.fbq=function(){d.callMethod?d.callMethod.apply(d,arguments):d.queue.push(arguments)},c._fbq||(c._fbq=d),d.push=d,d.loaded=!0,d.version="2.0",d.queue=[],(s=i.createElement(l)).async=!0,s.src="https://connect.facebook.net/en_US/fbevents.js",(u=i.getElementsByTagName(l)[0]).parentNode.insertBefore(s,u)),fbq("init","225304889304715"),fbq("track","PageView"),e=window,t=document,e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:2184169,hjsv:6},r=t.getElementsByTagName("head")[0],(o=t.createElement("script")).async=1,o.src="https://static.hotjar.com/c/hotjar-"+e._hjSettings.hjid+".js?sv="+e._hjSettings.hjsv,r.appendChild(o)}}()}();
//# sourceMappingURL=analytics.js.map